function init(){var t=window.height();480>=t?($("body").addClass("iphone4"),$("#beerBuddyBanner").attr("src","img/beer-buddy-iphone4.png")):($("body").addClass("iphone5"),$("#beerBuddyBanner").attr("src","img/beer-buddy-iphone5.png")),getStreamInfo(),getDateInfo(),html5audio.play()}function onError(t){console.log(t.message)}function onConfirmRetry(t){1==t&&html5audio.play()}function pad2(t){return(10>t?"0":"")+t}function beerbuddy(){window.open("http://cocktailnapkinstudios.com/beerbuddy?utm_source=ios&utm_medium=app&utm_campaign=beerbuddy","_blank","location=yes")}function getStreamInfo(){var t={};$.ajax({type:"GET",url:"http://cp6.shoutcheap.com:2199/rpc/jeremyfu/streaminfo.get",dataType:"jsonp",data:t,success:function(t){parseStreamInfo(t)}})}function parseStreamInfo(t){var e="img/on-air-live.png",a="img/offline.png",n=t.data[0],o=n.track.title,r=n.track.album,i="http://cocktailnapkinstudios.com/images/uploads/"+r.toLowerCase(),s=n.server;"Online"==s?("On Air LIVE"==o?$("#albumArt").attr("src",e):$("#albumArt").attr("src",i),$("#currentTrack").html(o)):($("#currentTrack").html("Currently Offline"),$("#albumArt").attr("src",a)),1==isPlaying&&setTimeout(function(){getStreamInfo()},1e3)}function getDateInfo(){var t={};$.ajax({type:"GET",url:"http://www.google.com/calendar/feeds/calendar%40jeremyfuksa.com/public/full?alt=json&orderby=starttime&max-results=1&singleevents=true&sortorder=ascending&futureevents=true",dataType:"jsonp",data:t,success:function(t){parseDateInfo(t)}})}function parseDateInfo(t){var e=t.feed,a=e.entry[0].gd$when[0].startTime.substring(0,19);$("#nextSession").html(Date.parse(a).toString("MMMM d, h:mmtt")+" Central")}var progressTimer,playButton,stopButton,activityIndicator,textPosition,myaudioURL="http://184.154.90.186:8064/stream",myaudio=new Audio(myaudioURL),isPlaying=!1,readyStateInterval=null,html5audio={play:function(){isPlaying=!0,myaudio.play(),playButton.className="transport hidden",stopButton.className="transport pause",readyStateInterval=setInterval(function(){myaudio.readyState<=2&&(textPosition.innerHTML="Loading&hellip;")},1e3),myaudio.addEventListener("timeupdate",function(){var t=parseInt(myaudio.currentTime%60),e=parseInt(myaudio.currentTime/60%60),a=parseInt(myaudio.currentTime/60/60%60);isPlaying&&myaudio.currentTime>0&&(textPosition.innerHTML=pad2(a)+":"+pad2(e)+":"+pad2(t))},!1),myaudio.addEventListener("error",function(){console.log("myaudio ERROR")},!1),myaudio.addEventListener("canplay",function(){console.log("myaudio CAN PLAY")},!1),myaudio.addEventListener("waiting",function(){console.log("myaudio WAITING"),isPlaying=!1},!1),myaudio.addEventListener("playing",function(){isPlaying=!0},!1),myaudio.addEventListener("ended",function(){html5audio.stop(),navigator.notification.confirm("Streaming failed. Possibly due to a network error.",onConfirmRetry,"Stream error","Retry,OK")},!1)},pause:function(){isPlaying=!1,clearInterval(readyStateInterval),myaudio.pause(),stopButton.className="transport pause hidden",playButton.className="transport"},stop:function(){isPlaying=!1,clearInterval(readyStateInterval),myaudio.pause(),stopButton.className="transport pause hidden",playButton.className="transport",myaudio=null,myaudio=new Audio(myaudioURL),textPosition.innerHTML="Stopped."}};